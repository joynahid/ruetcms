<<<<<<< HEAD
{% extends 'defaults/column3layout.html' %} {% block title %} {{profile['name']}} {%endblock%}

<div class="row">
    {% with messages = get_flashed_messages(with_categories=true) %} {% if messages %} {% for category, message in messages %}
=======
{% extends 'defaults/authlayout.html' %}
{% block title %} {{auth['personal']['firstname']}} {%endblock%}

{% block fullcontent %}

<div class="row">
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    {% for category, message in messages %}
>>>>>>> 66894d29abca90a0e11a4c213d858d344b7ac9af
    <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
        <i class="fas fa-info-circle"></i> {{ message }}
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
<<<<<<< HEAD
    {% endfor %} {% endif %} {% endwith %} {% block bigcolumn %}
    <div class="card shadow-cs mb-4">
        <div class="card-body border-0">
            <div class="card-title border-0 bg-white">
                Basic Information
            </div>

            <hr>

            <div class="card-text">
                Name
            </div>
            <div class="card-text">
                <b>{{profile['name']}}</b>
            </div>

            <br>

            <div class="card-text">
                Codeforces
            </div>
            <div class="card-text">
                <b><a href="https://codeforces.com/profile/{{profile['cf']}}" target="_blank">{{profile['cf']}}</a></b>
            </div>

            <br>

            <div class="card-text">
                Institute
            </div>
            <div class="card-text">
                <b id='organization'></b>
            </div>
        </div>
    </div>

    {% endblock %} {% block midcolumn %}
    <div class="card shadow-cs mb-4">
        <div class="card-body">
            <div class="card-title">
                Recent Activity
            </div>
            <hr>

            <div class="card-text" id="blog-posting-activity">

            </div>
        </div>
    </div>
    {% endblock %} {% block smallcolumn %} {% include 'plugins/cfprofile.html' %} {% endblock %}
</div>

{% block script %}

<script>
    let uri = 'https://codeforces.com/api/user.info?handles='

    let cf_username = "{{ profile['cf'] }}"

    uri += cf_username + '&lang=en'
    let usr = cf_username + '__'

    if (localStorage.getItem(usr)) {
        data = JSON.parse(localStorage.getItem(usr))
        $('#title_photo').attr('src', data['titlePhoto']);
        $('#max_rank').html(data['maxRank'])
        $('#max_rating').html(data['maxRating'])
        $('#organization').html(data['organization'])
    } else {
        $.getJSON(uri, function(data, status) {
            data = data['result'][0]
            console.log(data)
            $('#title_photo').attr('src', data['titlePhoto']);
            $('#max_rank').html(data['maxRank'])
            $('#max_rating').html(data['maxRating'])
            $('#organization').html(data['organization'])
            localStorage.setItem(usr, JSON.stringify(data))
        });
    }
</script>

{% include './scripts/cfprofile_script.html' %} {% include './scripts/retrieve_individual_blogposts.html' %} {%endblock%}
=======
    {% endfor %}
    {% endif %}
    {% endwith %}

    <div class="col-sm-4">
        <div class="card rounded shadow-sm" style="max-width: 300px; text-align: center;">
            <!-- <div class="card-header bg-dark text-white"> Codeforces Profile </div> -->
            <img src="{{ info['titlePhoto'] }}" width="100%" />
            <div class="card-body">
                <p style="font-size: 18px;"> <b>{{auth['personal']['firstname']}}</b></p>
                <hr>
                <p class="p-0 m-0" style="font-weight: bold;">
                    <small>
                        <span id="fletter"
                            style="color:{{color}}; text-transform: uppercase; font-weight: bold; font-size: 12">{{ info['maxRank'] }}</span>
                    </small>
                </p>
                <p id='rating'>{{ info['maxRating'] }}</p>
            </div>
        </div>
    </div>

    <div class="col-sm-8">
        <div>
            <div class="display-4 pb-4">
                Basic Information
                <hr>
            </div>
            <div class="display-4" style="font-size: 1.5em;">
                Username
            </div>
            <div class="display-4 pb-4" style="font-size: 2em;">
                <b>{{auth['personal']['username']}}</b>
            </div>

            <div class="display-4" style="font-size: 1.5em;">
                Name
            </div>
            <div class="display-4 pb-4" style="font-size: 2em;">
                <b>{{auth['personal']['firstname']}} {{auth['personal']['lastname']}}</b>
            </div>

            <div class="display-4" style="font-size: 1.5em;">
                Codeforces
            </div>
            <div class="display-4 pb-4" style="font-size: 2em;">
                <b><a href="https://codeforces.com/profile/{{auth['ojinfo']['codeforces']}}"
                        target="_blank">{{auth['ojinfo']['codeforces']}}</a></b>
            </div>

            <div class="display-4" style="font-size: 1.5em;">
                Institute
            </div>
            <div class="display-4 pb-4" style="font-size: 2em;">
                <b>{{info['organization']}}</b>
            </div>

        </div>

        <canvas id="myChart" width="400"></canvas>
    </div>
</div>

{% endblock %}

{%block script%}
<script type="text/javascript">
    $(document).ready(function () {

        $.ajax({
            type: "GET",
            url: "https://codeforces.com/api/user.rating?handle=" + "{{ info['handle'] }}",
            data: '',
            success: function (data) {
                var cnt = 1;

                var lbls = [];
                var dd = [];
                var bgcolor = [];

                function getRandomColor() {
                    var letters = 'ABCDEF0123456789';
                    var color = '#';
                    for (var i = 0; i < 6; i++) {
                        color += letters[Math.floor(Math.random() * 16)];
                    }
                    return color;
                }

                $.each(data.result, function (key, element) {
                    lbls.push(element.newRating);
                    dd.push(cnt++);
                    bgcolor.push(getRandomColor());


                    var ctx = document.getElementById('myChart').getContext('2d');
                    var myChart = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: dd,
                            datasets: [{
                                backgroundColor: "transparent",
                                label: 'Rating',
                                data: lbls,
                                fill: false,
                                borderColor: ['{{color}}'],
                                pointBackgroundColor: bgcolor,
                                borderWidth: 3,
                                pointRadius: 2
                            }]
                        },
                        options: {
                            tooltips: { enabled: false },
                            hover: { mode: null },
                            title: {
                                display: true,
                                text: 'Rating Curve'
                            },
                            legend: {
                                display: false
                            },
                            scales: {
                                xAxes: [{
                                    gridLines: {
                                        display: true
                                    }
                                }],
                                yAxes: [{
                                    gridLines: {
                                        display: true
                                    }
                                }]
                            }
                        }
                    });
                });
            },
            error: function (xmlHttpRequest, textStatus, errorThrown) {
                alert(errorThrown);
            }
        });
    });
</script>
{%endblock%}
>>>>>>> 66894d29abca90a0e11a4c213d858d344b7ac9af
